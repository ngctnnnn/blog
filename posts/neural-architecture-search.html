<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Neural Architecture Search | A technical blog</title>
    <meta name="description" content="The official blog">
    <link rel="stylesheet" href="/assets/style.a95e0a9f.css">
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="twitter:title" content="Neural Architecture Search | A technical blog">
    <meta property="og:title" content="Neural Architecture Search | A technical blog">
  </head>
  <body>
    <div id="app"><div class="antialiased"><div class="flex bg-white"><nav class="z-50 fixed w-full flex justify-center py-3 font-bold bg-white border border-fuchsia-600"><div class="w-full flex justify-between px-4 sm:px-6 xl:max-w-5xl xl:px-0"><a class="text-xl" href="/" aria-label="A technical blog"><img class="inline-block mr-2 spin-img" style="width:36px;height:31px;" alt="logo" src="/logo.png"><span class="hidden md:inline nav-text">A technical blog</span></a><div class="text-base text-gray-500 leading-5 space-x-6"><a class="hover:text-gray-700 text-xl" href="https://github.com/ngctnnnn/ngctnnnn.github.io" target="_blank" rel="noopener">About us</a></div></div></nav></div><main class="max-w-3xl mx-auto px-4 sm:px-6 xl:max-w-5xl xl:px-0 mt-14"><article class="xl:divide-y xl:divide-gray-200"><header class="pt-6 xl:pb-10 space-y-1 text-center"><dl><dt class="sr-only">Published on</dt><dd class="text-base leading-6 font-medium text-gray-500"><time datetime="2022-02-12T12:00:00.000Z">February 12, 2022</time></dd></dl><h1 class="text-3xl leading-9 font-extrabold text-gray-900 tracking-tight sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Neural Architecture Search</h1></header><div class="divide-y xl:divide-y-0 divide-gray-200 xl:grid xl:grid-cols-4 xl:gap-x-10 pb-16 xl:pb-20" style="grid-template-rows:auto 1fr;"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center xl:block space-x-8 sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://gravatar.com/avatar/6c1ae5231dcadf6b4297a6ddf6315478?s=80" alt="author image" class="w-10 h-10 rounded-full"><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900">Tan Ngoc Pham</dd><dt class="sr-only">Linkedin</dt><dd><a href="https://linkedin.com/in/ngctnnnn" target="_blank" rel="noopnener noreferrer" class="link">@ngctnnnn</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 xl:pb-0 xl:col-span-3 xl:row-span-2"><div style="position:relative;" class="prose max-w-none pt-10 pb-8"><div><p>The needs for appropriate deep neural networks for most modern problems have increased dramatically, and finding the right architecture is a challenge. Almost deep architectures nowadays are manually designed with tremendous times of trial-and-errors and state-of-the-arts are those with multiple layers, connections ignoring a suitable explanation.</p><hr><h4 id="table-of-contents" tabindex="-1">Table of contents <a class="header-anchor" href="#table-of-contents" aria-hidden="true">#</a></h4><ul><li><ol><li><a href="#:~:text=1.%20Introduction">Introduction</a></li></ol></li><li><ol start="2"><li><a href="#:~:text=2.%20Recent%20literature%20on%20Neural%20Architecture%20Search">Recent literature on Neural Architecture Search</a></li></ol></li><li><ol start="3"><li><a href="#:~:text=3.%20Conclusions">Conclusion</a></li></ol></li></ul><hr><h3 id="_1-introduction" tabindex="-1">1. Introduction <a class="header-anchor" href="#_1-introduction" aria-hidden="true">#</a></h3><ul><li>NAS&#39;s concept begins with a <em><strong>search space</strong></em> of S, which could be under the form of different to-find-layers (macro-level), various operations (micro-level) or even different complete architectures that we would like to find. The paradigm then flows to the <em><strong>search strategy</strong></em> in which our heuristics would perform their strength towards the problem, e.g. Genetic Algorithm, Reinforcement Learning.</li><li>On applying the suitable search strategy to the search space, one (or many) architectures is picked up from the search space and put into the <em><strong>evaluation step</strong></em>. The chosen architecture is evaluated by real training on the given dataset and the fitness is returned as the form of our wanted metric for the problem.</li><li>This whole procedure is <em><strong>repeated continuously</strong></em> until we found out the outperformed architecture for the problem or the algorithm met the <em><strong>terminated criterion</strong></em>, i.e. number of iterations, out of computational resources. <p align="center"><img width="80%" src="/NAS.png" alt="paradigm"><div align="center"><b> Fig 1.</b> Paradigm of NAS </div></p></li></ul><h3 id="_2-recent-literature-on-neural-architecture-search" tabindex="-1">2. Recent literature on Neural Architecture Search <a class="header-anchor" href="#_2-recent-literature-on-neural-architecture-search" aria-hidden="true">#</a></h3><h4 id="a-neural-optimizer-search-with-reinforcement-learning" tabindex="-1">a. <a href="http://proceedings.mlr.press/v70/bello17a/bello17a.pdf" target="_blank" rel="noopener noreferrer">Neural Optimizer Search with Reinforcement Learning</a> <a class="header-anchor" href="#a-neural-optimizer-search-with-reinforcement-learning" aria-hidden="true">#</a></h4><p>Mentioning NAS often means mentioning the work of <a href="http://proceedings.mlr.press/v70/bello17a/bello17a.pdf" target="_blank" rel="noopener noreferrer">Zoph and Le. 2017</a> on first bringing out the concept of finding neural architecture and how to resolve the problem. The very first solution for the NAS is to use a <em><strong>Recurrent Neural Network controller</strong></em> to generate a string representating the outcome network using <strong>Reinforcement Learning</strong> in which:</p><ul><li>The <ins>environment</ins> for the NAS is the search space of the problem.</li><li>The <ins>actions</ins> are the search strategies that we would love to apply on.</li><li>The <ins>reward</ins> is the accuracy of the chosen architecture trained on CIFAR-10 dataset.</li></ul><p>The results towards the initial approach is outstanding when the final architectures have a tendency to <strong>converge near the state-of-the-art architectures</strong> that we know nowadays, e.g. <strong>AlexNet</strong> [<a href="https://dl.acm.org/doi/10.5555/2999134.2999257" target="_blank" rel="noopener noreferrer">Krizhevsky et al. (2012)</a>] or <strong>VGG</strong> [<a href="https://arxiv.org/abs/1409.1556" target="_blank" rel="noopener noreferrer">Simonyan and Zisserman (2014)</a>]. And moreover, the result architecture is not overfitted on the train dataset but has a strong transferability when testing on different datasets.</p><p>However, the approach costs a fortune of computational resources since each step, they have to construct the network from the beginning and the network has to be trained from scratch. The power of the very first method of NAS and the limitations from computational process is the primary motivation for later works on various aspects which are search spaces, datasets, training-free methods and so on.</p><h4 id="b-nas-benchmark" tabindex="-1">b. NAS Benchmark: <a class="header-anchor" href="#b-nas-benchmark" aria-hidden="true">#</a></h4><p>On resolving the problem of training from scratch on the way, NAS Benchmark has been born to minimize the computational costs that researchers demand when doing the NAS. There are a great amount of NAS Benchmarks nowadays but there are 2 most highlighted ones in the field.</p><ul><li><strong>NAS-Bench-101 [<a href="https://arxiv.org/abs/1902.09635" target="_blank" rel="noopener noreferrer">Ying et al. (2019)</a>]</strong><br> Developed by Google, NAS-Bench-101 is constructed with a compact, yet expressive, search space, exploiting graph isomorphisms to identify <strong>423 000 unique convolutional architectures</strong> on CIFAR-10 dataset. NAS-Bench-101 is simply used by querying based on the upper-triangular matrix representating the formulation of the network we would like to evaluate.</li></ul><div class="language-python"><pre><code><span class="token comment"># Load the data from file (this will take some time)</span>
nasbench <span class="token operator">=</span> api<span class="token punctuation">.</span>NASBench<span class="token punctuation">(</span><span class="token string">&#39;/path/to/nasbench.tfrecord&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Create an Inception-like module (5x5 convolution replaced with two 3x3</span>
<span class="token comment"># convolutions).</span>
model_spec <span class="token operator">=</span> api<span class="token punctuation">.</span>ModelSpec<span class="token punctuation">(</span>
    <span class="token comment"># Adjacency matrix of the module</span>
    matrix<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># input layer</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 1x1 conv</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 3x3 conv</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 5x5 conv (replaced by two 3x3&#39;s)</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 5x5 conv (replaced by two 3x3&#39;s)</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 3x3 max-pool</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment"># output layer</span>
    <span class="token comment"># Operations at the vertices of the module, matches order of matrix</span>
    ops<span class="token operator">=</span><span class="token punctuation">[</span>INPUT<span class="token punctuation">,</span> CONV1X1<span class="token punctuation">,</span> CONV3X3<span class="token punctuation">,</span> CONV3X3<span class="token punctuation">,</span> CONV3X3<span class="token punctuation">,</span> MAXPOOL3X3<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Query this model from dataset, returns a dictionary containing the metrics</span>
<span class="token comment"># associated with this model.</span>
data <span class="token operator">=</span> nasbench<span class="token punctuation">.</span>query<span class="token punctuation">(</span>model_spec<span class="token punctuation">)</span>
</code></pre></div><p>The result achieved on this benchmark is under the format of a json:</p><div class="language-python"><pre><code>data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;module_adjacency&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;module_operations&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;trainable_parameters&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;training_time&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;train_accuracy&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;validation_accuracy&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;test_accuracy&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>NATS-Bench [<a href="https://arxiv.org/abs/2009.00437" target="_blank" rel="noopener noreferrer">Dong et al. (2021)</a>]</strong><br> The NATS-Bench is the upgraded version of a previous work NAS-Bench-201. NATS-Bench includes the search space of <strong>15,625 neural cell candidates</strong> for architecture topology and <strong>32,768 for architecture size</strong> on three dataset (<strong>CIFAR-10</strong>, <strong>CIFAR-100</strong>, <strong>ImageNet16-120</strong>).</li></ul><div class="language-python"><pre><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
Create the benchmark instance
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> nats_bench <span class="token keyword">import</span> create
<span class="token comment"># Create the API instance for the size search space in NATS</span>
api <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&#39;sss&#39;</span><span class="token punctuation">,</span> fast_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Create the API instance for the topology search space in NATS</span>
api <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&#39;tss&#39;</span><span class="token punctuation">,</span> fast_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
Query the performance
&quot;&quot;&quot;</span>
<span class="token comment"># Query the loss / accuracy / time for 1234-th candidate architecture on CIFAR-10</span>
<span class="token comment"># info is a dict, where you can easily figure out the meaning by key</span>
info <span class="token operator">=</span> api<span class="token punctuation">.</span>get_more_info<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">,</span> <span class="token string">&#39;cifar10&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Query the flops, params, latency. info is a dict.</span>
info <span class="token operator">=</span> api<span class="token punctuation">.</span>get_cost_info<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">&#39;cifar10&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>The result from querying NATS-Bench is a json of multiple metrics on 2 different epochs:</p><div class="language-python"><pre><code>info <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;train-loss&#39;</span>     <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;train-accuracy&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;train-per-time&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;train-all-time&#39;</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  
    <span class="token string">&#39;test-loss&#39;</span>      <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;test-accuracy&#39;</span>  <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;test-per-time&#39;</span>  <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
    <span class="token string">&#39;test-all-time&#39;</span>  <span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-conclusions" tabindex="-1">3. Conclusions <a class="header-anchor" href="#_3-conclusions" aria-hidden="true">#</a></h4><ul><li>Manual construction on deep neural networks is a time-consumed, high computational consuming and specified works.</li><li>Neural Architecture Search is the field when we minimize the labour on evaluating separated architectures for a typical dataset.</li></ul></div></div></div><footer class="text-sm font-medium leading-5 divide-y divide-gray-200 xl:col-start-1 xl:row-start-2"><div class="pt-8"><a class="link" href="/">← Back to the blog</a></div></footer></div><footer class="text-sm font-medium leading-5 divide-y divide-gray-200 xl:col-start-1 xl:row-start-2" style="display:inline-flex;justify-content:space-between;width:100%;"><div style="display:inline-flex;justify-content:space-between;width:100%;"><div class="py-8"><h2 class="text-xs tracking-wide uppercase text-gray-500"> Previous Article </h2><div class="link"><a href="/posts/computer-vision-for-leukocyte-prediction-2.html">← Leukocyte classification to predict diseases (Part 2)</a></div></div><div class="py-8"><h2 class="text-xs tracking-wide uppercase text-gray-500"> Next Article </h2><div class="link"><a href="/posts/introduction-to-reinforcement-learning.html">An introduction to Reinforcement Learning →</a></div></div></div></footer></article></main></div></div>
    
    
    
  </body>
</html>